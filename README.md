# オレオレ証券取引所

リアルタイム証券取引所シミュレータ - Ada タスク通信のデモンストレーション

## プロジェクト概要

このプロジェクトは Ada の *rendezvous* を使ったタスク間通信のデモンストレーションです。
リアルタイムで動作する架空の証券取引所システムをシミュレートし、ANSI カラーを使った
派手なターミナルUIで表示します。

## 主な機能

- 価格フィード: ランダム価格の生成と配信（1秒間隔）
- 注文受付: LIMIT または MARKET 注文の送信（Buy/Sell）
- マッチング: 注文板での FIFO マッチング処理
- 約定通知: 約定結果の関連クライアントへの通知
- イキりメーター: 取引回数をカラーバーで表示

## 開発環境

本プロジェクトは完全な Docker 開発環境を提供しています。ホスト OS に Ada や Alire を
インストールする必要はありません。

### 前提条件

- Docker と Docker Compose がインストールされていること
- （推奨）VS Code + Dev Containers 拡張機能

### 環境構築手順

```bash
# 1. Dockerイメージをビルド
docker compose build

# 2. 開発用シェルを起動
docker compose run --rm exchange bash

# --- 以下、コンテナ内 ---
# 3. ビルドスクリプトを実行
chmod +x /workspace/build.sh
/workspace/build.sh

# 4. プログラム実行
./bin/oreore_exchange     # サーバー + 管理者クライアント起動
```

### 追加クライアントの起動

別のターミナルで以下のコマンドを実行して、追加のクライアントを起動できます：

```bash
# 新しいターミナルでクライアント追加
docker compose exec exchange ./bin/client --nick Alice
```

## 使い方

1. サーバーとデフォルトクライアントが起動すると、取引画面が表示されます
2. 画面の指示に従って注文を入力できます：
   - 1: 買い指値
   - 2: 買い成行
   - 3: 売り指値
   - 4: 売り成行
   - 0: 終了

## 実装の詳細

- PriceFeed タスク: 1秒ごとにランダム価格を生成
- OrderBook タスク: 注文の受付とマッチング処理
- Client タスク: 価格更新と約定通知の受信、注文の送信
- ターミナル UI: ANSI エスケープシーケンスを使った派手な表示

## VS Code での開発

1. VS Code で本プロジェクトを開く
2. コマンドパレットから「Dev Containers: Reopen in Container」を選択
3. コンテナ内で自動的に開発環境が構築されます
